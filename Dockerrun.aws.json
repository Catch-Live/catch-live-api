{
  "AWSEBDockerrunVersion": 2,
  "containerDefinitions": [
    {
      "name": "main",
      "image": "<ECR_MAIN_IMAGE_URL>",
      "essential": true,
      "memory": 512,
      "portMappings": [{ "hostPort": 3000, "containerPort": 3000 }],
      "environment": [
        { "name": "ALLOW_ALL_IP", "value": "${ALLOW_ALL_IP}" },
        { "name": "YOUTUBE_API_KEYS", "value": "${YOUTUBE_API_KEYS}" },
        { "name": "AWS_ACCESS_KEY_ID", "value": "${AWS_ACCESS_KEY_ID}" },
        { "name": "AWS_SECRET_ACCESS_KEY", "value": "${AWS_SECRET_ACCESS_KEY}" },
        { "name": "AWS_REGION", "value": "${AWS_REGION}" },
        { "name": "S3_BUCKET_NAME", "value": "${S3_BUCKET_NAME}" },
        { "name": "DATABASE_URL", "value": "${DATABASE_URL}" },
        { "name": "DB_HOST", "value": "${DB_HOST}" },
        { "name": "DB_PORT", "value": "${DB_PORT}" },
        { "name": "DB_USER", "value": "${DB_USER}" },
        { "name": "DB_PASSWORD", "value": "${DB_PASSWORD}" },
        { "name": "DB_NAME", "value": "${DB_NAME}" },
        { "name": "KAKAO_CLIENT_ID", "value": "${KAKAO_CLIENT_ID}" },
        { "name": "KAKAO_REDIRECT_URI", "value": "${KAKAO_REDIRECT_URI}" },
        { "name": "NAVER_CLIENT_ID", "value": "${NAVER_CLIENT_ID}" },
        { "name": "NAVER_CLIENT_SECRET", "value": "${NAVER_CLIENT_SECRET}" },
        { "name": "NAVER_STATE", "value": "${NAVER_STATE}" },
        { "name": "GOOGLE_CLIENT_ID", "value": "${GOOGLE_CLIENT_ID}" },
        { "name": "GOOGLE_CLIENT_SECRET", "value": "${GOOGLE_CLIENT_SECRET}" },
        { "name": "GOOGLE_REDIRECT_URI", "value": "${GOOGLE_REDIRECT_URI}" },

        { "name": "JWT_ACCESS_SECRET", "value": "${JWT_ACCESS_SECRET}" },
        { "name": "JWT_REFRESH_SECRET", "value": "${JWT_REFRESH_SECRET}" },

        { "name": "REDIS_HOST", "value": "${REDIS_HOST}" },
        { "name": "REDIS_PORT", "value": "${REDIS_PORT}" },
        { "name": "REDIS_MAX_RETRIES", "value": "${REDIS_MAX_RETRIES}" },
        { "name": "REDIS_RETRY_DELAY", "value": "${REDIS_RETRY_DELAY}" },

        { "name": "MAX_CONCURRENT_RECORDINGS", "value": "${MAX_CONCURRENT_RECORDINGS}" }
      ]
    },
    {
      "name": "monitor",
      "image": "<ECR_MONITOR_IMAGE_URL>",
      "essential": false,
      "memory": 256,
      "portMappings": [{ "containerPort": 3001 }],
      "environment": [
        { "name": "ALLOW_ALL_IP", "value": "${ALLOW_ALL_IP}" },
        { "name": "YOUTUBE_API_KEYS", "value": "${YOUTUBE_API_KEYS}" },
        { "name": "AWS_ACCESS_KEY_ID", "value": "${AWS_ACCESS_KEY_ID}" },
        { "name": "AWS_SECRET_ACCESS_KEY", "value": "${AWS_SECRET_ACCESS_KEY}" },
        { "name": "AWS_REGION", "value": "${AWS_REGION}" },
        { "name": "S3_BUCKET_NAME", "value": "${S3_BUCKET_NAME}" },
        { "name": "DATABASE_URL", "value": "${DATABASE_URL}" },
        { "name": "DB_HOST", "value": "${DB_HOST}" },
        { "name": "DB_PORT", "value": "${DB_PORT}" },
        { "name": "DB_USER", "value": "${DB_USER}" },
        { "name": "DB_PASSWORD", "value": "${DB_PASSWORD}" },
        { "name": "DB_NAME", "value": "${DB_NAME}" },
        { "name": "KAKAO_CLIENT_ID", "value": "${KAKAO_CLIENT_ID}" },
        { "name": "KAKAO_REDIRECT_URI", "value": "${KAKAO_REDIRECT_URI}" },
        { "name": "NAVER_CLIENT_ID", "value": "${NAVER_CLIENT_ID}" },
        { "name": "NAVER_CLIENT_SECRET", "value": "${NAVER_CLIENT_SECRET}" },
        { "name": "NAVER_STATE", "value": "${NAVER_STATE}" },
        { "name": "GOOGLE_CLIENT_ID", "value": "${GOOGLE_CLIENT_ID}" },
        { "name": "GOOGLE_CLIENT_SECRET", "value": "${GOOGLE_CLIENT_SECRET}" },
        { "name": "GOOGLE_REDIRECT_URI", "value": "${GOOGLE_REDIRECT_URI}" },
        { "name": "JWT_ACCESS_SECRET", "value": "${JWT_ACCESS_SECRET}" },
        { "name": "JWT_REFRESH_SECRET", "value": "${JWT_REFRESH_SECRET}" },
        { "name": "REDIS_HOST", "value": "${REDIS_HOST}" },
        { "name": "REDIS_PORT", "value": "${REDIS_PORT}" },
        { "name": "REDIS_MAX_RETRIES", "value": "${REDIS_MAX_RETRIES}" },
        { "name": "REDIS_RETRY_DELAY", "value": "${REDIS_RETRY_DELAY}" },
        { "name": "MAX_CONCURRENT_RECORDINGS", "value": "${MAX_CONCURRENT_RECORDINGS}" }
      ]
    },
    {
      "name": "worker1",
      "image": "<ECR_WORKER1_IMAGE_URL>",
      "essential": false,
      "memory": 1536,
      "cpu": 1024,
      "environment": [
        { "name": "ALLOW_ALL_IP", "value": "${ALLOW_ALL_IP}" },
        { "name": "YOUTUBE_API_KEYS", "value": "${YOUTUBE_API_KEYS}" },
        { "name": "AWS_ACCESS_KEY_ID", "value": "${AWS_ACCESS_KEY_ID}" },
        { "name": "AWS_SECRET_ACCESS_KEY", "value": "${AWS_SECRET_ACCESS_KEY}" },
        { "name": "AWS_REGION", "value": "${AWS_REGION}" },
        { "name": "S3_BUCKET_NAME", "value": "${S3_BUCKET_NAME}" },
        { "name": "DATABASE_URL", "value": "${DATABASE_URL}" },
        { "name": "DB_HOST", "value": "${DB_HOST}" },
        { "name": "DB_PORT", "value": "${DB_PORT}" },
        { "name": "DB_USER", "value": "${DB_USER}" },
        { "name": "DB_PASSWORD", "value": "${DB_PASSWORD}" },
        { "name": "DB_NAME", "value": "${DB_NAME}" },
        { "name": "REDIS_HOST", "value": "${REDIS_HOST}" },
        { "name": "REDIS_PORT", "value": "${REDIS_PORT}" },
        { "name": "REDIS_MAX_RETRIES", "value": "${REDIS_MAX_RETRIES}" },
        { "name": "REDIS_RETRY_DELAY", "value": "${REDIS_RETRY_DELAY}" },
        { "name": "MAX_CONCURRENT_RECORDINGS", "value": "${MAX_CONCURRENT_RECORDINGS}" }
      ]
    },
    {
      "name": "worker2",
      "image": "<ECR_WORKER2_IMAGE_URL>",
      "essential": false,
      "memory": 1536,
      "cpu": 1024,
      "environment": [
        { "name": "ALLOW_ALL_IP", "value": "${ALLOW_ALL_IP}" },
        { "name": "YOUTUBE_API_KEYS", "value": "${YOUTUBE_API_KEYS}" },
        { "name": "AWS_ACCESS_KEY_ID", "value": "${AWS_ACCESS_KEY_ID}" },
        { "name": "AWS_SECRET_ACCESS_KEY", "value": "${AWS_SECRET_ACCESS_KEY}" },
        { "name": "AWS_REGION", "value": "${AWS_REGION}" },
        { "name": "S3_BUCKET_NAME", "value": "${S3_BUCKET_NAME}" },
        { "name": "DATABASE_URL", "value": "${DATABASE_URL}" },
        { "name": "DB_HOST", "value": "${DB_HOST}" },
        { "name": "DB_PORT", "value": "${DB_PORT}" },
        { "name": "DB_USER", "value": "${DB_USER}" },
        { "name": "DB_PASSWORD", "value": "${DB_PASSWORD}" },
        { "name": "DB_NAME", "value": "${DB_NAME}" },
        { "name": "REDIS_HOST", "value": "${REDIS_HOST}" },
        { "name": "REDIS_PORT", "value": "${REDIS_PORT}" },
        { "name": "REDIS_MAX_RETRIES", "value": "${REDIS_MAX_RETRIES}" },
        { "name": "REDIS_RETRY_DELAY", "value": "${REDIS_RETRY_DELAY}" },
        { "name": "MAX_CONCURRENT_RECORDINGS", "value": "${MAX_CONCURRENT_RECORDINGS}" }
      ]
    }
  ]
}
